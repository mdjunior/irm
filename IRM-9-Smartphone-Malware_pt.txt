IRM # 9
Malware em smartphones
Como lidar com um smartphone suspeito
___________________________________________________

E-Mail: 
Web: 
Twitter: 

0 - Resumo

Esta metodologia de Resposta a Incidentes é um folha de dicas dedicada a tratadores de incidentes que estão investigando um problema de segurança específico.

Quem deve usar as folhas de IRM?

• Administradores
• Security Operation Center, ou CSIRTs
• CISOs e suplentes
• CERT (Computer Emergency Response Team)

Lembre-se: Se você enfrentar um incidente, siga a IRM, tome notas e não entre em pânico. Contate seu CERT imediatamente, se necessário.

0.1 - Tratamento das etapas do Incidente

6 passos são definidos para lidar com incidentes de segurança

Preparação: se preparar para lidar com o incidente
Identificação: detectar o incidente
Contenção: limitar o impacto do incidente
Correção: remover a ameaça
Recuperação: recuperar para um estágio normal
Resultados Finais: elaborar e melhorar o processo

O IRM fornece informações detalhadas para cada etapa.

Este documento é de uso público

1 - Preparação

Objetivo: Estabelecer contatos, definir procedimentos e reunir informações para economizar tempo durante um ataque.

■ O helpdesk deve ter um processo definido para dispositivos móveis em caso de suspeita de infecção por malware: substituir o smartphone do usuário com um novo e isolar o dispositivo suspeito para análise pelo investigador forense.
■ Um bom conhecimento da atividade usual do smartphone é apreciado (padrão e ferramentas extras em execução). Um especialista de suporte em smartphone pode ser útil para auxiliar o investigador forense.
■ Um monitoramento deve ser feito para verificar o usuário incomum ou atividade de rede anômala.
 
2 - Identificação

Objetivo: Detectar o incidente, determinar o seu escopo, e envolver as partes apropriadas.

Principais pontos de notificação para smartphones suspeitos:

■ Antivirus levanta alertas;
■ Atividade do sistema incomum, o sistema fica extraordinariamente lento;
■ Atividade de rede incomum, conexão com a Internet muito lenta;
■ O sistema é reiniciado ou trava sem razão;
■ Algumas aplicações falham inesperadamente;
■ Usuário recebe mensagens de um ou vários, alguns poderiam ter caracteres especiais (SMS, MMS, mensagens de Bluetooth, etc);
■ Enorme aumento na conta de telefone ou atividade web.
■ Chamadas para números de telefone incomuns ou em horários/dias incomuns.

Evidências, tais como URLs site precisam ser recolhidas.

Perguntar ao usuário sobre a sua atividade habitual no smartphone: quais sites são navegados, que aplicações externas estão instalados. Esta informação pode, opcionalmente, ser cruzados com a política da empresa.

3 - Contenção

Objetivo: mitigar os efeitos do ataque no ambiente alvo.

■ Certifique-se de que é dado ao usuário um dispositivo temporário ou permanente novo para evitar qualquer restrição de tempo na investigação.
■ Faça backup dos dados smartphone.
■ Remova a bateria para bloquear todas as atividades (wi-fi, Bluetooth, etc).
■ Inicie uma verificação antivírus nos computadores que são/foram sincronizados ou ligados com o smartphone.
■ Envie o smartphone suspeitos e componentes adequados (SIM, bateria, cabo de alimentação, cartões de memória) para a sua equipe de resposta a incidentes de segurança. Essa equipe vai ajudar a isolar o conteúdo malicioso e enviá-la para empresas de antivírus.

4 - Remediação

Objetivo: Tomar medidas para remover a ameaça e evitar futuros incidentes.

Se alguns acessos de criptografia ou senhas são definidas, descobrir uma maneira de obter acesso aos dados armazenados. Se isso não for possível, a investigação vai sofrer sérias limitações.

Ferramentas específicas devem ser usadas por sua equipe de resposta a incidentes para conduzir investigação forense sobre o smartphone.

Apenas para informação, aqui está uma pequena lista de ferramentas que podem ser úteis:

Ferramentas gratuitas: XDA Utils (Windows Mobile), MIAT (Mobile Internal Acquisition Tool – Symbian, Windows Mobile), TULP2G, Blackberry Desktop Manager
Ferramentas comerciais: XRY, Cellebrite, Paraben ...

Ações:
■ Remova SIM do smartphone se não tiver feito;
■ Recupere o histórico do telefone, histórico da web e todos os registros disponíveis;
■ Recupere as conexões de log do servidor, se disponíveis;
■ Identifique e remova a ameaça sobre o smartphone.
■ Se a ameaça está relacionada com uma aplicação instalada, identificar sua localização na Internet e removê-la.

5 - Recuperação

Objetivo: restaurar o sistema para operações normais.

Se o usuário precisa recuperar o material infectado, defina um período de quarentena e verifique com um anti-vírus apropriado, se possível, para assegurar que nada poderia prejudicar usuário ou sistema da empresa.

Restaure os dados salvos anteriormente de uma fonte confiável sobre o dispositivo de destino.

Uma vez que as investigações estão a cargo, limpe o smartphone infectado (se possível) e redefina-o para as configurações de fábrica com um firmware puro e sistema de arquivos, a fim de ser usado novamente.

6 - Resultados Finais

Objetivo: Documente os detalhes do incidente, discutir as lições aprendidas, e ajustar os planos e as defesas.

6,1 - Relatório

Um relatório de incidente deve ser escrito e disponibilizado a todos os atores.

Os seguintes temas devem ser descritos:
■ Detecção inicial
■ Ações e prazos
■ O que deu certo
■ O que deu errado
■ Custo Incident

6.2 - Capitalize

Ações para melhorar a política de smartphones devem ser definidos para capitalizar sobre essa experiência.

Discuta o incidente com o usuário para melhorar a sua consciência dos problemas de segurança.
